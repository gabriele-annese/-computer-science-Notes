
Malware Sample 
**PMAT-labs/labs/3-5.GoTime-GoMalware/Backdoor.srvupdat.exe.malz.7z**

# Static Analysis
## Go indicator
We a few indicators that the malware are written in Go like 
- OSX or Linux samples with embedded URLs referencing ‘Go.org’
- Samples using the ‘Go-http-client/1.1’ user-agent
- Samples using the ‘GRequests’ user-agent
- PE samples containing the ‘.symtab’ section name
- PE samples using a series of identified import hashes
- OSX samples referencing Google’s gopacket github repository
- OSX samples referencing gopkg.in

Examinate the floss output
User=agent of this PE is `Go-http-client`

![[Pasted image 20250208131817.png]]

we can find the **gopacket github** repositories 
```bash
cat .\strings.txt | findstr.exe go.itab.github.com
```
![[Pasted image 20250208132057.png]]

If we examinate the PE file we can notice `.symtab` section, another go indicators. 
![[Pasted image 20250208132147.png]]
Symbol Table (.symtab) is the section were go include the symbols for garbage collection and for internal debugs.

# Dynamic Analysis

We can analyze the user-agent even during dynamic analysis
![[Pasted image 20250208133123.png]]

#### DNS requets
The malware perform a dns request to `ec2-3-109-20-24-srv3.local` domain

## Reference 

[Unit42 Go Analysis](https://unit42.paloaltonetworks.com/the-gopher-in-the-room-analysis-of-golang-malware-in-the-wild/)
