# Introduction
In this section we explore basics static analysis on excel file using [oledump](https://github.com/DidierStevens/DidierStevensSuite/blob/master/oledump.py) tool.

sample: **PMAT-labs/labs/3-1.GonePhishing-MaldocAnalysis/Excel/sheetsForFinancial.7z**


# Excel Basic Analysis
The .xlsm extensions means its excel file with macro.
Infect if we unzip this file we notice the are few file inside.
![[Pasted image 20250114063330.png]]

The vbaProject.bin contains the possible macro
![[Pasted image 20250114063458.png]]
using oledump we can see in the 3 section we have the macro
```bash
oledump.py vbaProject.bin
```
![[Pasted image 20250114063552.png]]
with oledump its possible view the strings inside of macros with `-S` flag
```bash
oledump.py -s 3 -S vbaProject.bin
```

with oledump its possible decompress the macro section to view the code macro
```bash
oledump.py -s 3 --vbadecompress vbaProject.bin
```

![[Pasted image 20250114063827.png]]

## Code Analysis
As we can see the macro call the `http://srv3.wonderballfinancial.local/abc123.crt` endpoint and download the certificate, after use `cmd` command to decode the the `encd.crt` write `run.ps1` and execute the script with PowerShell `c:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -ep bypass -W Hidden .\run.ps1`
![[Pasted image 20250114064445.png]]

# Word Basic Analysis
The word file .docm contains a macro we can verify that with oldedump, this contains the same code of the excel
![[Pasted image 20250114220608.png]]

Unziped the .docx word file
![[Pasted image 20250114220842.png]]
under the `\word\_rels\settings.xml.rels` we can notice the target argument of the file download a macro file `.dotm`

![[Pasted image 20250114221304.png]]
We the docx will be executed that get and executed the `macro3.dotm` file