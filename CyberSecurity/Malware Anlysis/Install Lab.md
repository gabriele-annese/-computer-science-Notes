# Hyper Visor
Its's important install isolate vm where we analyze malwares.
There are two principal hyper visor:
- Virtual Box
- VmWare

# Install Windows 
To install windows 10 navigate the following link:
- [https://www.microsoft.com/en-us/evalcenter/download-windows-10-enterprise](https://www.microsoft.com/en-us/evalcenter/download-windows-10-enterprise)


# Install FlareVM
FlareVM is a stock windows installation within the tools for malware analysis:
- https://github.com/mandiant/flare-vm
- Download Windows Terminal:
    - Download the VCLibs package. In a PowerShell window, run: `wget https://aka.ms/Microsoft.VCLibs.x64.14.00.Desktop.appx -usebasicparsing -o VCLibs.appx`
    - Download the Windows Terminal MSIX bundle from the provided link: `wget https://github.com/microsoft/terminal/releases/download/v1.15.3465.0/Microsoft.WindowsTerminal_Win10_1.15.3465.0_8wekyb3d8bbwe.msixbundle -UseBasicParsing -o winterminal.msixbundle`
    - In a PowerShell admin window, add the VCLibs package: `Add-AppxPackage [C:\path\to\downloaded\VCLibs.appx]`
    - In a PowerShell admin window, run: `Add-AppxPackage [C:\path\to\downloaded\winterminal.msixbundle]`
    - (Optional) Pin Windows Terminal to the task bar
- Disable proxy auto detect setting:
    - In the Windows search bar, search “proxy settings”,
    - Switch "Automatically detect settings" button off
- Disable Tamper Protection
    - Search "Defender", open Defender settings and set all Defender Settings to off
- Disable AV/Defender in GPO
    - In Windows search bar, search "group policy"
    - In GPO, navigate to → Administrative Templates → Windows Components → Microsoft Defender Antivirus → Enable “Turn off Microsoft Defender Antivirus”
- Disable Windows Firewall
    - GPO → Administrative Templates → Network → Network Connections → Windows Defender Firewall → Domain Profile → Disable “Protect All Network Connections”
    - Do the same but for the Standard profile
- TAKE A SNAPSHOT!
- Download and install FLARE-VM:
    - In PowerShell Admin prompt, run: `(New-Object net.webclient).DownloadFile('https://raw.githubusercontent.com/mandiant/flare-vm/main/install.ps1',"$([Environment]::GetFolderPath("Desktop"))\install.ps1")`
    - Change directories to the Desktop
    - Run: `Unblock-File .\install.ps1`
    - Run: `Set-ExecutionPolicy Unrestricted`
    - Accept the prompt to set the ExecPol to unrestricted if one appears
    - Run: `.\install.ps1 -customConfig https://raw.githubusercontent.com/HuskyHacks/PMAT-labs/main/config.xml`
    - Follow the rest of the prompts and continue with the installation.
- When the installation is done, TAKE ANOTHER SNAPSHOT!

# Install REMnux
REMnux is a Linux distribution for malware analysis. To install REMnux navigate the following link and read the instructions to import the OVA file in your hyper-visor ;) :
- https://docs.remnux.org/install-distro/get-virtual-appliance

# Analysis Network Setup
Go to **Edit < Virtual Network Editor** click on Add New Network.
- Enable DCHP Service
	- Started IP: 10.0.0.1
	- Ended IP: 10.0.0.0.254
	- SubNet Mask: 255.255.255.0
- Disable "Connect a host virtual adapter to this network"
- Subet IP: 10.0.0.0
- SubNet Mask: 255.255.255.0
Go in the VM settings select "Custom Specific virtual network" and choose the network that you created.

# INetSim Setup
Create a fake internet connection to trick malware with INetSim.
