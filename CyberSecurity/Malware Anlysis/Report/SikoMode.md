
# Static Analysis
# Hashes

| MD5     | b9497ffb7e9c6f49823b95851ec874e3                                                                                                 |
| ------- | -------------------------------------------------------------------------------------------------------------------------------- |
| SHA1    | 6c8f50040545d8cd9af4b51564de654266e592e3                                                                                         |
| SHA-256 | 3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e                                                                 |
| SHA-384 | d45589ce2cb780b741af008f41cad2de9c03606cdc5ce574924946970910b9d6a88222e74894ab540a4bbc2900c0f79c                                 |
| SHA-512 | 080f39efdf983802e77765be4396f4545bf8396ed6b2a7d4f3922af52487abf66069d2b838a06f667788bcaba3a6a5e4008e642f69f2227a5398f4e0d5f9d18f |

## Virus Total 
There a match on virus total for the [3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e](https://www.virustotal.com/gui/file/3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e) malware .

# Strings
The suspicious strings identify from PeStudio are this
```text
GetCurrentProcessId
GetCurrentProcessId
GetCurrentProcessId
QueryPerformanceFrequency
connect
send
select
inet_ntop
WSAStartup
socket
closesocket
WSAIoctl
getaddrinfo
freeaddrinfo
__WSAFDIsSet
recv
InternetOpen
InternetOpenUrl
InternetCloseHandle
socket
VirtualAlloc
VirtualProtect
VirtualQuery
VirtualProtect
VirtualQuery
VirtualQuery
VirtualProtect
VirtualAlloc
FindFirstFile
GetCurrentProcess
GetCurrentThreadId
RtlAddFunctionTable
TerminateProcess
TerminateProcess
GetCurrentThreadId
GetCurrentProcess
RtlAddFunctionTable
TerminateProcess
RtlAddFunctionTable
GetCurrentProcess
GetCurrentThreadId
```

# Import Table 

## DLL

| KERNEL32.dll | Windows NT BASE API Client           |
| ------------ | ------------------------------------ |
| msvcrt.dll   | Microsoft C Runtime Library          |
| USER32.dll   | User Windows USER API Client Library |

## Suspicious Function

| DLL          | Function            |
| ------------ | ------------------- |
| KERNEL32.dll | GetCurrentProcessId |
| KERNEL32.dll | VirtualAlloc        |
| KERNEL32.dll | VirtualProtect      |
| KERNEL32.dll | VirtualQuery        |
| KERNEL32.dll | GetCurrentProcess   |
| KERNEL32.dll | GetCurrentThreadId  |
| KERNEL32.dll | RtlAddFunctionTable |
| KERNEL32.dll | TerminateProcess    |

SikoMode is **x64** architecture malware we can identify in the IMAGE_FILE_HEADER > machine section of PE header. The 8664 value correspond with the x64 base arch.
![[Pasted image 20241225212342.png]]

The SikoMode malware was develop using **Nim compiler**, this ca be view using PeStduio under the indicator section.


# Assembly
Since the malware are write in `nim` we have a few main function in cutter.
![[Pasted image 20241226185420.png]]

Under the `NimMainModule` function we can view the malware call the `checkKillSwitchURL__sikomode_25` function.
![[Pasted image 20241226185630.png]]
If the result is 0 will be execute `houdini__sikomode_51` function and that delete itself.
![[Pasted image 20241226192353.png]]

If the URL respond the sikoMode malware execute first the `unpackResources__sikomode_17` and after the `stealStuff__sikomode_130`.
![[Pasted image 20241226193238.png]]

Inside of  `stealStuff__sikomode_130` i founded the `toRC4__OOZOOZOOZOOZOOZOnimbleZpkgsZ8267524548O49O48Z826752_51` where the malware encode and send the data
![[Pasted image 20241226193529.png]]

# Dynamic Analysis
## Network
The malware delete itself if the DNS query of `update.ec12-4-109-278-3-ubuntu20-04.local` domain dosent respond
![[Pasted image 20241225235001.png]]

The malware when are connect on internet perform a GET HTTP request to contact the 
`http[:]//update.ec12-4-109-278-3-ubuntu20-04[.]local/`

![[Pasted image 20241226002113.png]]

after that preform a DNS query for the `cdn.altimiter.local` domain 
![[Pasted image 20241226002400.png]]

The malware semes send the encrypted or decoded `cosmo.jpeg` data trough a GET request in the `post` parameter.
![[Pasted image 20241226003348.png]]

![[Pasted image 20241226002531.png]]
Endpoint:
`http[:]//cdn.altimiter[.]local/feed?post=A8E437E8F0367592569A2870BBDD382A1DFBB01A15FC23999D7788C33502AD9256E481B402BDC6BC25167B6478F204C49A9BADD68C4AC2A617437ECCBBA9`


## Host Base
The malware create password.txt under the `C:\Users\Public\` path. And read something in the `cosmo.jpg` file.

![[Pasted image 20241226002959.png]]