## Introduction

The intent of this workshop is to reverse engineer existing malware to extract the portable executable (PE) injection technique to be replicated for use for red team operation tooling. The content of this workshop will begin by reverse engineering the malware Cryptowall and then go over the injection technique. The injection sequence consists of writing code into a newly created executable section in the target process, then using NtQueueApcThread to execute the target code.

## What you'll do

Reverse engineer the malware Cryptowall to replicate the PE injection technique.

## What you'll learn

- Recognizing and bypassing a custom unpacking routine
- Recognizing control flow obfuscation
- Recognizing import table restoration
- View new executable memory sections in a newly created process
- Work with undocumented Windows API
- Walk through a portable executable injection routine
- How Asynchronous Procedure Calls (APC) work
- Writing PE injection in Golang

## What you'll need

- Virtual Machine with Windows 10
- At least 4 GB of RAM
- At least 20 GB of storage
- Ida Pro/Free Disassembler
- X64dbg
- 7Zip
- Sysinternals Suite
- PE Bear