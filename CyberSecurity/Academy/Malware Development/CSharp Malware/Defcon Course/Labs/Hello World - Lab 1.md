In this lab we write two "Hello World" project. The first use **.NETs Console** to print the message. The second use the **.NETs Platform** Invocation Services feature to import and call the **Win32 API MessageBox**.

## Hello World .NETs Console
Using a C# compiler ***C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe***  compile the 1.cs file. When run it we see the .NET Shell open
![[Pasted image 20240808233509.png]]

## Hello World .NETs Win32 API
Using the same c# compiler compile the "2.cs" file and run it. We notice the messagebox appears on the screen 
![[Pasted image 20240808233822.png]]

## Review 1.exe and 2.exe with our Blue team tools.

Analyze the 1.exe using CFF Explorer we can see on the import directory the exe import only the mscoree DLL. This is correct because we are using .NET Framework.

![[Pasted image 20240808234602.png]]

Using Procmon we can see the 2.exe loading user32.dll
![[Pasted image 20240808235346.png]]


## Code difference

1.exe is simple "Hello World" project the code is the follow 
```c#
using System;

class Program 
{
	static void Main() 
	{
		Console.WriteLine("Hello World!");
		Console.WriteLine("Press any key to exit.");
		Console.ReadKey();
	}
}

```


2.exe is not simple "Hello World" because we are import in run time the user32.dll

>NOTE
>this is why can see this dll only with procmon and not in static analysis using CFF explorer. 

the code is follow 
```c#
using System;
using System.Runtime.InteropServices;

public class Program
{
    [DllImport("user32.dll", CharSet = CharSet.Unicode)]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, uint type);
    
    static void Main()
    {
        MessageBox(new IntPtr(0), "Hello World from user32's MessageBox!!", "Important Dialog", 0);
    }
}
```



